plugins {
   id "java-library"
   id "eclipse"   
}

java {
	toolchain {
		languageVersion = JavaLanguageVersion.of(8)
	}
}

repositories {
	mavenCentral()
	maven {
		url "https://files.minecraftforge.net/maven"
	}
}

configurations {
    asm
    implementation.extendsFrom asm
    annotationProcessor.extendsFrom asm
}

dependencies {
	compileOnly project(":Mapped-Minecraft")
			
	asm "org.ow2.asm:asm:9.0"
    asm "org.ow2.asm:asm-commons:9.0"
    asm "org.ow2.asm:asm-tree:9.0"
	asm "org.ow2.asm:asm-analysis:9.0"
	asm "org.ow2.asm:asm-util:9.0"
	
	implementation "org.spongepowered:mixin:0.8.2"	
	annotationProcessor "org.spongepowered:mixin:0.8.2:processor"
}

def mixin_ap = file("$buildDir/mixin_ap")
def mixin_tsrg = file("${mixin_ap}/out.tsrg")
def mixin_refmap = file("${mixin_ap}/refmap.json")

mixin_ap.mkdirs()

tasks.withType(JavaCompile) {
	options.compilerArgs += "-AdefaultObfuscationEnv=searge"
    options.compilerArgs += "-AmappingTypes=tsrg"
	options.compilerArgs += "-AreobfTsrgFile=${mapping_to_obf.canonicalPath}"
	options.compilerArgs += "-AoutTsrgFile=${mixin_tsrg.canonicalPath}"
	options.compilerArgs += "-AoutRefMapFile=${mixin_refmap.canonicalPath}"
}

jar {
}